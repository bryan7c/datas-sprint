"use strict";angular.module("datasSprintApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial"]).config(["$routeProvider",function(t){t.when("/main",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/",{templateUrl:"views/gerarador.html",controller:"GeraradorCtrl",controllerAs:"gerador"}).when("/gerador",{templateUrl:"views/gerarador.html",controller:"GeraradorCtrl",controllerAs:"gerador"}).when("/gerador-by-lista",{templateUrl:"views/gerador-by-lista.html",controller:"GeradorByListaCtrl",controllerAs:"geradorByLista"}).otherwise({redirectTo:"/gerador"})}]),angular.module("datasSprintApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],this.menu=[{title:"Criar Sprint",active:!1,link:"#/gerador"},{title:"Gerar por lista",active:!1,link:"#/gerador-by-lista"}]}),angular.module("datasSprintApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("datasSprintApp").controller("GeraradorCtrl",["$scope","SprintAPI","$mdSidenav","$filter","$mdToast",function(a,e,t,i,r){function n(){e.init(a.gerador.sprint),a.gerador.sprint=e.getSprint()}function o(){t("right").open().then(function(){console.log("aberto")})}this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],this.sprint={},this.sprint.dataInicio=new Date,this.sprint.dias=1,this.sprint.usarDiasUteis=!0,this.dataMax=new Date(this.sprint.dataInicio.getFullYear(),this.sprint.dataInicio.getMonth(),this.sprint.dataInicio.getDate()+14),this.dataMin=new Date(this.sprint.dataInicio.getFullYear(),this.sprint.dataInicio.getMonth(),this.sprint.dataInicio.getDate()-3),e.init(this.sprint),this.sprint=e.getSprint(),this.closeNav=function(){t("right").close().then(function(){console.log("fechado")})},this.openNav=function(){o()},this.adicionarEstoria=function(t){e.addEstoria(t),this.sprint=e.getSprint(),this.estoria={},a.formEstoria.$setUntouched(),formEstoria.nome.focus()},this.iniciarInclusao=function(){n(),o()},a.$watch("gerador.sprint",function(){n()},!0),a.$watch("gerador.sprint.feriado",function(){a.gerador.sprint.feriado&&function(t){t=t||"Deu zica";var a=r.simple().content(t).action("OK").highlightAction(!1).position("top right");r.show(a)}("Este sprint contém um feriado!")},!0)}]),angular.module("datasSprintApp").factory("SprintAPI",["dateUtil",function(i){var r,n={};n.usarDiasUteis=!1;var e=function(t){r=t},a=function(){var a=r,e=angular.copy(n.dataInicio);n.estorias.forEach(function(t){for(;t.pontos>=a;)a+=r,e=i.incrementDay(e,1,n.usarDiasUteis);a-=t.pontos,t.data=e})},o=function(){n.dataFim=i.incrementDay(n.dataInicio,n.dias,n.usarDiasUteis)},s=function(){var t,a=0;n.estorias.forEach(function(t){a+=t.pontos}),t=a,n.pontos=t,e(n.pontos/n.dias)};return{init:function(t){n.dataInicio=t.dataInicio,n.dias=t.dias,n.usarDiasUteis=t.usarDiasUteis,n.pontos=1,n.feriado=i.hasHoliday,e(n.pontos/n.dias),o(),n.estorias&&(s(),a())},getSprint:function(){return n},addEstoria:function(t){t&&(n.estorias||(n.estorias=[]),t.nome=t.nome||"story-"+(n.estorias.length+1),n.estorias.push(t),s()),a()},getEstorias:function(){return n.estorias},getDataFim:function(){return n.dataFim},getPontos:function(){return n.pontos}}}]),angular.module("datasSprintApp").service("dateUtil",["$http",function(t){var i=[],r=[],a=new Date;function n(t){try{if(""===t)throw"empty";if(!t)throw"Not is valid";if("Date"!==t.constructor.name)throw"Not is a Date type";var a=t.toISOString();return r.indexOf(a.substring(0,11)+"00:00:00")}catch(t){console.error("date-util: isHoliday error:"+t)}}t.get("http://services.sapo.pt/Holiday/GetNationalHolidays?year="+a.getFullYear()).then(function(t){!function(t){var a=(new DOMParser).parseFromString(t,"text/xml");a=a.getElementsByTagName("Holiday");for(var e=0;e<a.length;e++)i.push({nome:a[e].getElementsByTagName("Name")[0].innerHTML,date:new Date(a[e].getElementsByTagName("Date")[0].innerHTML),description:a[e].getElementsByTagName("Description")[0].innerHTML}),r.push(a[e].getElementsByTagName("Date")[0].innerHTML)}(t)}),this.hasHoliday=!1,this.incrementDay=function(t,a,e){e=e||!1,this.hasHoliday=!1;var i=new Date(t);if(0<a)for(var r=0;r<a;)i.setDate(i.getDate()+1),(!e||0!==i.getDay()&&6!==i.getDay())&&(-1<n(i)?this.hasHoliday=!0:r++);return i},this.intervalDay=function(t,a,e){e=e||!1;var i=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),r=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),n=Math.floor((r-i)/864e5);if(e){for(var o=0;t!==a;)t.setDate(t.getDate()+1),0!==t.getDay()&&6!==t.getDay()&&o++;n=o}return n}}]),angular.module("datasSprintApp").controller("GeradorByListaCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("datasSprintApp").run(["$templateCache",function(t){t.put("views/about.html","<p>This is the about view.</p> "),t.put("views/gerador-by-lista.html","<p>This is the gerador-by-lista view.</p> "),t.put("views/gerarador.html",' <form name="formGerador"> <div layout="row" layout-wrap layout-align="space-between center"> <div flex="30" flex-order="1" flex-sm="60"> <md-datepicker ng-model="gerador.sprint.dataInicio" md-placeholder="Data do início do Sprint" md-min-date="gerador.dataMin" md-max-date="gerador.dataMax" required></md-datepicker> </div> <div flex="40" flex-order="2" flex-sm="40"> <md-input-container> <label>Quantidade de dias</label> <input ng-model="gerador.sprint.dias" type="number" max="14" min="1" required> </md-input-container> </div> <div flex="30" flex-order="3" flex-sm="100"> <md-checkbox ng-model="gerador.sprint.usarDiasUteis" aria-label="Usar dias úteis"> Considerar dias úteis </md-checkbox> </div> <div flex="30" flex-order="4" flex-sm="60"> <md-datepicker ng-model="gerador.sprint.dataFim" md-placeholder="Data do fim do Sprint" disabled></md-datepicker> </div> <div flex="70" flex-order="5" flex-sm="40"> <md-input-container> <label>Quantidade de pontos</label> <input ng-model="gerador.sprint.pontos" type="number" max="999" min="1" disabled> </md-input-container> </div> </div> </form> <div class="table-responsive"> <table class="table table-striped" ng-if="gerador.sprint.estorias"> <thead> <tr> <th>Estoria</th> <th>Pontos</th> <th>Tasks</th> <th>Data de entrega</th> </tr> </thead> <tbody> <tr ng-repeat="estoria in gerador.sprint.estorias"> <td>{{estoria.nome}}</td> <td>{{estoria.pontos}}</td> <td>{{estoria.tasks}}</td> <td>{{estoria.data | date: \'dd/MM\'}} \x3c!-- <md-input-container>\r\n\t\t\t\t\t  <input type="text" value="{{estoria.data |  date: \'dd/MM\'}}" />\r\n\t\t\t\t\t</md-input-container> --\x3e </td> \x3c!-- <td>\r\n\t\t\t\t\t<md-button class="md-icon-button" aria-label="Settings">\r\n\t\t\t\t\t\t<md-icon aria-label="Delete">\r\n\t\t\t\t\t\t\t<i class="material-icons md-24">delete</i>\r\n\t\t\t\t\t\t</md-icon>\r\n\t\t\t\t    </md-button>\r\n\t      \t\t</td> --\x3e </tr> </tbody> </table> </div> <div layout="row" layout-align="end end"> <md-button class="md-fab" aria-label="Eat cake" ng-disabled="formGerador.$invalid" ng-click="gerador.iniciarInclusao()"> <md-icon aria-label="Adicionar estoria"> <i class="material-icons md-24">add</i> </md-icon> <md-tooltip> Adicionar estoria </md-tooltip> </md-button> </div> <md-sidenav class="md-sidenav-right md-whiteframe-z2" md-component-id="right"> <md-toolbar class="md-theme-light"> <h1 class="md-toolbar-tools">Adicionar Estoria</h1> </md-toolbar> <md-content layout-padding> <form name="formEstoria"> <md-input-container> <label for="nome">Estoria</label> <input type="text" name="nome" id="nome" ng-model="gerador.estoria.nome" md-autofocus> </md-input-container> <md-input-container> <label for="pontos">Pontos</label> <input type="number" name="pontos" id="pontos" ng-model="gerador.estoria.pontos" min="1" required> </md-input-container> <md-input-container> <label for="tasks">Quantidade de tasks</label> <input type="number" name="tasks" id="tasks" ng-model="gerador.estoria.tasks" min="1" required> </md-input-container> </form> <md-button ng-click="gerador.closeNav()"> Cancelar </md-button> <md-button ng-click="gerador.adicionarEstoria(gerador.estoria)" class="md-primary" ng-disabled="formEstoria.$invalid"> Add estoria </md-button> </md-content> </md-sidenav>'),t.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.c582c4d1.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div> ')}]);